#!/bin/sh

operation=$1
curval=$(v4l2-ctl -C "exposure_absolute" | cut -d: -f2 | tr -d ' ')

case $operation in
  reset)
    v4l2-ctl -c "exposure_auto=1"
    v4l2-ctl -c "white_balance_temperature_auto=0"
    v4l2-ctl -l | sed 's/^[ \t]*//; s/\ .*default//; s/\ .*//' | sort | xargs -I {} v4l2-ctl -c "{}"
    ;;
  up)
    newval=$(($curval+10))
    v4l2-ctl -c "exposure_auto=1"
    v4l2-ctl -c "exposure_absolute=$newval"
    ;;
  down)
    newval=$(($curval-10))
    v4l2-ctl -c "exposure_auto=1"
    v4l2-ctl -c "exposure_absolute=$newval"
    ;;
  ''|*[!0-9]*)
    echo "Operation unknown"
    exit 1
    ;;
  *)
    newval=$operation
    ;;
esac
