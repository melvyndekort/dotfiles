#!/bin/bash

set -euo pipefail

# Check dependencies
command -v rofi >/dev/null || { echo "rofi not found" >&2; exit 1; }

# Helper function for chromium
launch_chromium() {
    local profile="$1"
    command -v chromium >/dev/null || { echo "chromium not found" >&2; exit 1; }
    
    local data_dir="${XDG_DATA_HOME:-$HOME/.local/share}/chromium/$profile"
    if [[ "$(command -v chromium)" == "/snap/bin/chromium" ]]; then
        data_dir="$HOME/snap/chromium/common/profiles/$profile"
    fi
    
    chromium --user-data-dir="$data_dir" &
}

# Get user choice
choice=$(rofi -dmenu -p 'Launch browser' << 'EOF'
ðŸ¦Š Firefox default
ðŸ•µï¸ Firefox private
âš™ï¸ Firefox ProfileManager
ðŸŒ Chromium default
ðŸ•µï¸ Chromium private
ðŸ¥· Chromium incognito
EOF
)

[[ -n "$choice" ]] || exit 0

case "$choice" in
    'ðŸ¦Š Firefox default')
        command -v firefox >/dev/null && firefox -P default &
        ;;
    'ðŸ•µï¸ Firefox private')
        command -v firefox >/dev/null && firefox -P private &
        ;;
    'âš™ï¸ Firefox ProfileManager')
        command -v firefox >/dev/null && firefox --ProfileManager &
        ;;
    'ðŸŒ Chromium default')
        launch_chromium default
        ;;
    'ðŸ•µï¸ Chromium private')
        launch_chromium private
        ;;
    'ðŸ¥· Chromium incognito')
        command -v chromium >/dev/null && chromium --incognito &
        ;;
esac
