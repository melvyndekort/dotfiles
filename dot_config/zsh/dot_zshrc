#           _              
#   _______| |__  _ __ ___ 
#  |_  / __| '_ \| '__/ __|
# _ / /\__ \ | | | | | (__ 
#(_)___|___/_| |_|_|  \___|
#                          

export PATH="$HOME/bin:$HOME/.local/bin:$HOME/src/portbase-bin:$PATH"

. ~/.profile

autoload bashcompinit
bashcompinit

if [ -f "/usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme" ]; then
  source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme
fi
if [ -f "/usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh" ]; then
  source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh
fi
if [ -f "/usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ]; then
  source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi

# Path to your oh-my-zsh installation.
ZSH=/usr/share/oh-my-zsh/

# Set name of the theme to load
#ZSH_THEME=""

# To customize prompt, run `p10k configure` or edit ~/.config/zsh/.p10k.zsh.
[[ -f ~/.config/zsh/.p10k.zsh ]] && source ~/.config/zsh/.p10k.zsh

# Uncomment the following line to use hyphen-insensitive completion.
HYPHEN_INSENSITIVE="true"

# Uncomment the following line to disable bi-weekly auto-update checks.
DISABLE_AUTO_UPDATE="true"

# Uncomment the following line to enable command auto-correction.
ENABLE_CORRECTION="false"

# Uncomment the following line to display red dots whilst waiting for completion.
COMPLETION_WAITING_DOTS="true"

# Uncomment the following line if you want to disable marking untracked files under VCS as dirty.
#DISABLE_UNTRACKED_FILES_DIRTY="true"

# Uncomment the following line if you want to change the command execution time stamp shown in the history command output.
HIST_STAMPS="yyyy-mm-dd"

# Would you like to use another custom folder than $ZSH/custom?
ZSH_CUSTOM=~/.oh-my-zsh/custom

# Change foreground color of the autosuggest plugin
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=10'

plugins=(archlinux autojump aws catimg common-aliases copyfile docker docker-compose emoji extract git git-extras gpg-agent history mvn nmap pip rsync ssh-agent sudo systemd terraform tmux vscode zsh-interactive-cd)

# Autostart tmux on zsh startup
ZSH_TMUX_AUTOSTART="false"

KEYS=""
for KEY in melvyn_ed25519 melvyn portbase portbase_ed25519; do
  if [ -f "$HOME/.ssh/$KEY" ]; then
    if [ ! -f "$HOME/.ssh/$KEY.pub" ]; then
      ssh-keygen -y -f "$HOME/.ssh/$KEY" > "$HOME/.ssh/$KEY.pub"
    fi
    KEYS="$KEYS $KEY"
  fi
done

# SSH agent configuration
zstyle :omz:plugins:ssh-agent agent-forwarding on
zstyle :omz:plugins:ssh-agent identities $(echo $KEYS | cut -d ' ' -f1-)

# Auto rehash
zstyle ':completion:*' rehash true

#Setup ZSH autocompletion
fpath=(
  ~/.awsume/zsh-autocomplete
  $fpath
)

# Load the oh-my-zsh framework
source $ZSH/oh-my-zsh.sh

# Load ZSH command line edit through editor
autoload edit-command-line
zle -N edit-command-line
bindkey '^Xe' edit-command-line

# Load ZSH bulk renamer
autoload zmv

# Control-space accepts the autosuggestion
bindkey '^ ' autosuggest-accept

